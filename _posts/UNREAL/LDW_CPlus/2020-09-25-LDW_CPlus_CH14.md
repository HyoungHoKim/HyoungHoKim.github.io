---
layout: post
title:  "이득우 C++ Chapter14"
date:   2020-09-25 17:26:07 +0900
categories: [UNREAL, UNREAL/LDW_CPLUS]
---

이득우의 언리얼 C++ 게임 개발의 정석의 Chapter14 요약입니다.

### 캐릭터 스테이트 설정
- 구현할 캐릭터 스테이트
    - PREINIT 스테이트 : 캐릭터 생성 전의 스테이트, 기본 캐릭터 애셋이 설정돼 있지만 캐릭터와 UI를 숨겨둔다. 해당 스테이트에서는 데미지를 입지 않는다.
    - LOADING 스테이트 : 선택한 캐릭터 애셋을 로딩하는 스테이트, 이 때는 게임이 시작된 지점으므로 현재 조종하는 컨트롤러가 AI인지 플레이어인지 구분할 수 있다. 플레이어 컨트롤러인 경우 애셋로딩이 완료될 때까지 캐릭터를 조종하지 못하도록 입력을 비활성화 한다.
    - READY 스테이트 : 캐릭터 애셋 로딩이 완료된 스테이트, 숨겨둔 캐릭터 UI를 보여주며, 이때부터는 공격을 받으면 대미지를 입는다. 플레이어 컨트롤러는 비로소 캐릭터를 조종할 수 있으며, AI 컨트롤러는 비헤비어 트리 로직을 구동해 캐릭터를 동작시킨다.
    - DEAD 스테이트 : 캐릭터가 HP를 소진해 사망할 때 발생하는 스테이트, 죽는 애니메이션을 재생하고 UI를 끄는 한편, 충돌 기능을 없애고 대미지를 입지 않도록 설정한다. 컨트롤러가 플레이어인 경우 입력을 비활성화 하고 AI인 경우 비헤비어 트리 로직을 중지한다. 일정 시간이 지난 후에는 플레이어의 경우 레벨을 재시작하고 AI는 레벨에서 퇴장한다.

### 플레이어 데이터와 UI연동
- 언리얼 엔진은 플레이어의 정보를 관리하기 위한 용도로 PlayerState라는 클래스를 제공한다.
- PlayerState에는 FString형의 PlayerName 속성과 float형의 Score 속성이 이미 설계되어 있다. 이 속성은 플레이어의 별명과 점수를 관리하기 위한 용도로 쓸 수 있다.
- 플레이어 컨트롤러의 구성을 완료하는 시점은 게임 모드의 PostLogin 함수이므로 이 때 함께 PlayerState의 초기화도 완료해주는 것이 좋다.
- 멀티 플레이까지 고려한다면 플레이어에 설정된 데이터 외에도 게임의 데이터를 관리하는 기능을 추가로 고려해야 한다. 언리얼 엔진은 이를 관리하도록 게임 스테이트라는 클래스를 제공한다.  
