---
layout: post
title:  "Oculus와 언리얼 엔진을 사용한 VR개발_C01"
date:   2020-11-29 18:37:27 +0900
categories: [UNREAL, UNREAL/OCULUS]
---

### 시작하며
- 언리얼 엔진 공식 홈페이지 온라인 러닝 프로젝트 중 \<Oculus와 언리얼 엔진을 사용한 VR개발\>에 대한 요약 및 정리입니다.
- 블루프린트로 진행되며, 프로젝트를 하는데 필요한 에셋은 모두 제공됩니다. 코스 설명대로 따라하면 다운받을 수 있습니다.
- 추후 C++로 바꿔볼 예정입니다.
- 관련 링크 : https://www.unrealengine.com/en-US/onlinelearning-courses/vr-development-with-oculus-and-unreal-engine

### 개요 및 라이팅 렌더링
- VR 렌더링 시 고려해야할 점
    - 프레임별 포함될 ms 수, 해상도
    - 픽셀당 라이트 수 그리고 필요하거나 선호할 새도 메서드 등
    - 머터리얼 복잡도와 언리얼 엔진에서 사용할 안티 에일리어싱 방식 등
- Quality VR Experiences Utilize
    - 높은 해상도
    - 높고 안정적인 프레임 속도
- Classic Forward Rendering
    - 지오메트리는 각 커버 픽셀의 채널과 함께 렌더링 됨. GPU는 텍스처 머티리얼 속성 및 라이팅 데이터를 기반으로 최종 GPU을 정확하게 계산해야함.
- Lighting Best Practice
    - 라이트는 제어 및 퍼포먼스가 좀 더 까다로움. 로컬 라이트는 감쇠 범위로 제한하는 것이 일반적임. 덕분에 개발자는 오브젝트가 영향을 받는 라이트 수를 제한할 수 있음.
- Forward Rendering Lighting Consideration
    - 라이팅 솔루션은 더 작게 제한을 해주어야 함. 오브젝트에 라이트가 거의 닿지 않더라도 해야함.
    - 전체 오브젝트는 하나의 라이트로 렌더링 되어야 함.
- Deferred Rendering Techniques
    - 다양한 기법이 존재하는데 모두 스크린 스페이스 정렬된 텍스처나 렌더 타겟에 대한 데이터 저장을 기반으로 함. 즉 각 화면 픽셀마다 머티리얼, 컬러,러프니스와 서피스 노멀 등 머트리얼 어트리뷰트를 저장하는 텍스처가 있다는 뜻임.
    - 일부 디퍼드 기법은 채널 몇 개만 있으면 됨. 예를 들어 첫번째 새도와 포그의 경우 Z버퍼에 대한 엑세스만 있으면 됨.
    - 모든 디퍼드 기법에 공통적으로 나타나는 요소는 뒤따르는 패스로부터 이런 어트리뷰트를 읽어들인다는 점임. 그래서 머티리얼 세이더로부터 스스로 효과적으로 디커플링함. 덕분에 보다 단순하고 세련된 코드가 가능해서 씬에서 더 나은 퍼포먼스와 유연성을 보여주는 결과물이 나옴. 하지만 읽고 쓰는데 메모리가 더 필요하다는 단점이 있음. 해상도가 높을수록 영향을 많이 미치고, 모바일 VR처럼 대역폭이 낮은 하드웨어에는 더 큰 영향이 있음.
- Classic Deffered Shading Passes
    - 모든 오브젝트가 픽셀 세이더 아웃풋을 내놓는 머티리얼 및 지오메트리 어트리퓨트로 렌더링되어 G버퍼에 들어감. 또 다른 디퍼드 패스에서는 세이딩이 G버퍼와 라이팅 정보를 사용해서 계산이 되는데 그 이유는 라이팅 복잡도가 머티리얼 복잡도를 제공한다면 디퍼드 세이딩은 많은 라이트와 함께 복잡한 머티리얼을 쓸 때도 깔끔한 단순성과 퍼포먼스를 제공하기 때문임.
    - 단점 중 하나는 안티 에일리어싱임. MSAA를 사용해서도 G버퍼를 렌더링할 수는 있지만 복잡도와 필요 메모리를 훨씬 더 추가하기 때문에 퍼포먼스도 떨어지게 되어서 현재는 언리얼 엔진에서 지원하지 않음.
- Temporal Anti-Aliasing
    - 이제는 템포럴 안티 에일리어싱, 즉 템포럴 AA를 이런 문제의 솔루션으로 활용함. 잠깐의 프레임만으로도 멋진 결과로 변환해냄. 즉 아직 화면에 없던 콘텐츠가 몇 프레임동안 흐릿하게 나왔다가 곧 뚜렷해진다는 뜻임. 또한 빠른 움직임이나 모션 오버 노이즈가 있는 콘텐츠는 뭉개져 나타날 수 있음. 템포럴 AA는 디퍼드 셰이딩과 함께 다루기에 아주 매력적인데 스페큘러 에일리어싱과 같은 문제를 MSAA보다 더 잘 해결합니다. 이런 메서드는 풀 스크린 버퍼링을 기반으로 하여 VR의 퍼포먼스 면에 더 큰 영향을 끼침.
- Fast Approximate Anti-Aliasing
    - FXAA, 일명 빠른 추정 안티 에일리어싱은 같은 문제이 대한 최신 솔루션으로 여타 제약이나 지연 변환이 나타나지 않음.
- 위 두가지 안티에일리싱 방법은 렌더 타깃 콘텐츠를 읽어오는데 의존하기 때문에 메모리 대역폭이 한정된 모바일에서는 손해를 보게됨.
- Pros and Cons
    - 첫번째 셰이딩의 경우 다양한 기능 활용에 큰 이점을 줌. 
